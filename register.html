<!doctype html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<link rel="stylesheet" type="text/css" href="bootstrap.css">
	<!--Favicons-->
	<link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">
	<link rel="manifest" href="/favicon/site.webmanifest">
	<link rel="mask-icon" href="/favicon/safari-pinned-tab.svg" color="#36464b">
	<link rel="shortcut icon" href="/favicon/favicon.ico">
	<meta name="msapplication-TileColor" content="#2b5797">
	<meta name="msapplication-config" content="/favicon/browserconfig.xml">
	<meta name="theme-color" content="#ffffff">
	<title>Tabulate | Register</title>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
	<script src="bootstrap.min.js"></script>
	<style>
	input[type="text"]::placeholder, input[type="email"]::placeholder, input[type="password"]::placeholder{
		text-align: center;
		color: black;
	}
	</style>
</head>

<body>
	<div id="navbar">
		<nav class="navbar navbar-dark bg-primary"><a type="button" class="btn btn-danger btn-lg" href="/nojs">No Javascript?</a></nav>
	</div>
	<div id="page-container">
		<div class="page-header">
			<div class="text-center">
				<h1>Register</h1>
			</div>
		</div>
		<div class="jumbotron">
			<div class="text-center">
				<form action="https://tabulatephp.azurewebsites.net/registration.php" method="POST" enctype="multipart/form-data">
					<div class="form-group">
						<label>Email</label>
						<input type="email" placeholder="Email" maxlength="255" name="email" class="form-control" required />
					</div>
					<div class="form-group">
						<label>Username</label>
						<input type="text" placeholder="Username" maxlength="255" name="user" class="form-control" pattern="\w+" title="Can Only be Letters and Numbers" required />
					</div>
					<div class="form-group">
						<label>Password</label>
						<input id="txtPassword" type="password" placeholder="Password" maxlength="255" name="password" class="form-control" pattern="(?=.*\d)(?=.*[a-z]).{6,}" title="Must contain at least one number and one lowercase letter, and at least 6 or more characters" required />
					</div>
					<div class="form-group">
						<label>Confirm Password</label>
						<input id="txtConfirmPassword" type="password" placeholder="Confirm Password" maxlength="255" class="form-control" required />
					</div>
					<p id="warnings" class="text-danger"></p>
					<hr class="my-4">
					<div data-theme="dark" class="g-recaptcha" data-sitekey="6LeSm_cUAAAAAGUz8yarXTZgNwameIiW9nSZfO0s" style="display:inline-block"></div>
					<br>
					<p class="lead">
						<button id="submit" type="submit" class="btn btn-primary btn-lg">Register</button>
					</p>
				</form>
				<script src='https://www.google.com/recaptcha/api.js'></script>
			</div>
			<a href="/login">Already Have an Account? Log in Here</a>
			<!-- LOAD NAVBAR-->
			<script>
			$(function() {
				$("#navbar").load("navbar.html");
			});

			$(function () {
				$("#submit").click(function () {
					var password = $("#txtPassword").val();
					var confirmPassword = $("#txtConfirmPassword").val();
					if (password != confirmPassword) {
						document.getElementById("txtConfirmPassword").className = "form-control is-invalid";
						return false;
					}
					document.getElementById("txtConfirmPassword").className = "form-control";
					return true;
				});
			});

			function getUrlVars() {
				var vars = {};
				var parts = window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi, function(m,key,value) {
					vars[key] = value;
				});
				return vars;
			}

			function getUrlParam(parameter, defaultvalue){
				var urlparameter = defaultvalue;
				if(window.location.href.indexOf(parameter) > -1){
					urlparameter = getUrlVars()[parameter];
				}
				return urlparameter;
			}

			var x = getUrlParam("success", "false");
			if(x == "user"){
				document.getElementById("warnings").innerHTML = "Username Taken";
			}else if (x == "email") {
				document.getElementById("warnings").innerHTML = "Email Taken";
			}else if (x == "captchafail") {
				document.getElementById("warnings").innerHTML = "ReCaptcha Failed. Please try again.";
			}
			</script>
		</div>
	</body>

	</html>
